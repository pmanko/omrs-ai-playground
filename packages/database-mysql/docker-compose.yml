services:
  mysql:
    image: ${MYSQL_IMAGE}
    command: mysqld --character-set-server=utf8 --collation-server=utf8_general_ci --sql_mode=""
    environment:
      - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PW}
      - MYSQL_ROOT_HOST=% # Allow docker containers to connect to mysql
      - MYSQL_DATABASE=${MYSQL_DATABASE:-openmrs}
      - MYSQL_USER=${MYSQL_USER:-openmrs}
      - MYSQL_PASSWORD=${MYSQL_PASSWORD:-openmrs}
      - MYSQL_ROOT_PASSWORD=${MYSQL_ROOT_PASSWORD:-openmrs}
    volumes:
      - mysql_data:/var/lib/mysql
    networks:
      - default
    deploy:
      replicas: 1

networks:
  default:
    name: instant
    external: true

volumes:
  mysql_data: